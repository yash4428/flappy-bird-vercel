<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="/" />
    <title>Flappy Bird</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      }
      body {
        min-height: 100vh;
        background: linear-gradient(135deg, #1d1d24 0%, #12121c 100%);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }
      .btn {
        padding: 12px 12px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: medium;
        font-weight: 600;
      }
      .btn-primary {
        background: linear-gradient(90deg, #85c8ff, #d6fa61);
        color: black;
        transition: transform 0.2s ease, opacity 0.2s ease;
      }
      .btn-primary:hover {
        opacity: 0.8;
      }
      .btn-primary:active {
        transform: translateY(0);
        opacity: 0.8;
      }
      .game-container {
        position: relative;
        width: 70vw;
        margin-left: 250px;
        height: 80vh;
        max-width: 1000px;
        max-height: 750px;
        border: 1px solid rgba(214, 250, 97, 0.5);
        border-radius: 20px;
        overflow: hidden;
        background: #1b2337;
        box-shadow: 0 0 15px #3f452b, 0 0 15px #d6fa61, 0 0 15px #d6fa61;
      }
      #videoElement {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transform: scaleX(-1);
      }
      #gameCanvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
      }
      .handCursor {
        position: absolute;
        width: 44px;
        height: 44px;
        background: rgba(169, 250, 48, 0.4);
        border-radius: 50%;
        border: 3px solid rgba(150, 255, 102, 0.8);
        box-shadow: 0 0 20px rgba(16, 185, 129, 0.4),
          inset 0 0 20px rgba(16, 185, 129, 0.2);
        pointer-events: none;
        z-index: 30;
        transition: transform 100ms, opacity 150ms;
        opacity: 0;
        transform: translate(-50%, -50%);
      }
      .hud {
        position: fixed;
        top: 55px;
        left: 20px;
        z-index: 50;
        background: rgba(17, 24, 39, 0.9);
        backdrop-filter: blur(12px);
        border-radius: 12px;
        padding: 20px;
        border: 1px solid #ff9cb3;
        box-shadow: 0 0 30px rgba(249, 180, 232, 0.6);
        min-width: 260px;
        justify-content: center;
        align-items: center;
      }
      .hud .grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 25px;
        text-align: center;
      }
      .hud .big {
        font-size: 28px;
        font-weight: bold;
      }
      .hud .label {
        font-size: 15px;
        color: #e1e4ea;
      }
      .hand-panel {
        position: fixed;
        top: 200px;
        left: 20px;
        z-index: 50;
        background: rgba(17, 24, 39, 0.95);
        backdrop-filter: blur(12px);
        border-radius: 16px;
        padding: 24px 32px;
        border: 1px solid rgba(133, 200, 255, 0.5);
        box-shadow: 0 0 20px rgba(133, 200, 255, 0.5);
        min-width: 260px;
        text-align: center;
      }
      .overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.92);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 60;
      }
      .overlay .box {
        background: #111827;
        border-radius: 16px;
        padding: 40px;
        border: 2px solid rgba(214, 250, 97, 0.3);
        text-align: center;
        max-width: 600px;
        animation: glowPulse 2s infinite alternate;
      }
      @keyframes glowPulse {
        from {
          box-shadow: 0 0 10px #596923, 0 0 20px #65713d, 0 0 30px #161345;
        }
        to {
          box-shadow: 0 0 20px #424c21, 0 0 40px #2b350a, 0 0 60px #141143;
        }
      }
    </style>
  </head>
  <body>
    <!-- HUD -->
    <div class="hud">
      <div class="grid">
        <div>
          <div id="score" class="big" style="color: #d6fa61">0</div>
          <div class="label">Score</div>
        </div>
        <div>
          <div id="lives" class="big" style="color: #ff9cb3">3</div>
          <div class="label">Lives</div>
        </div>
        <div>
          <div id="level" class="big" style="color: #85c8ff">1</div>
          <div class="label">Level</div>
        </div>
      </div>
      <div style="margin-top: 12px; text-align: center; font-size: 14px; color: #9ca3af;">
        Time: <span id="gameTime">0</span>s
      </div>
    </div>

    <!-- Hand Indicator -->
    <div class="hand-panel">
      <div style="display: flex; flex-direction: column; align-items: center; gap: 12px;">
        <div id="handStatus" style="width: 20px; height: 20px; border-radius: 50%; background: #ef4444;"></div>
        <div id="handText" style="font-size: 16px; color: #fca5a5; font-weight: 600;">No Hand Detected</div>
      </div>
    </div>

    <!-- Game Container -->
    <div class="game-container">
      <video id="videoElement" autoplay muted playsinline></video>
      <canvas id="gameCanvas"></canvas>
      <div id="handCursor1" class="handCursor"></div>
      <div id="handCursor2" class="handCursor"></div>
    </div>

    <!-- Game Over -->
    <div id="gameOverScreen" class="overlay">
      <div class="box">
        <h2 id="gameOverTitle" style="font-size: 32px; font-weight: bold; color: #3b82f6; margin-bottom: 30px;">Game Over!</h2>
        <div id="gameOverStats" style="color: #d1d5db; margin-bottom: 30px; font-size: 16px; line-height: 1.6;">
          <p>Score: 0</p><p>Level: 1</p><p>Time: 0s</p>
        </div>
        <button onclick="location.reload()" class="btn btn-primary" style="width:100%;margin-bottom:16px;">Play Again</button>
        <button onclick="window.location.href='/'" class="btn btn-secondary" style="width:100%;">← Back</button>
      </div>
    </div>

    <!-- Instructions -->
    <div id="instructionsScreen" class="overlay" style="display: flex;">
      <div class="box">
        <h2 style="font-size:36px; font-weight:bold; margin-bottom:20px;">Flappy Bird</h2>
        <p style="color:#d1d5db; margin-bottom:12px;">Raise your hand to make the bird go up, lower to go down.<br>Stay above waist level to start.<br><br><strong>Good luck!</strong></p>
        <button onclick="startGame()" class="btn btn-primary" style="width:100%;">Start</button>
      </div>
    </div>

    <!-- MediaPipe scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>

    <!-- Game JS -->
    <script>
      // (same JS logic as your original file – kept unchanged)
      // [Your JavaScript code goes here exactly as before...]
    </script>
  </body>
</html>